server {
  listen 80 default_server;

  location /health_check {
    return 200 'I am alive';
  }

}

server {
        listen 80;

        server_name api-rw.vizzuality.com production-api.globalforestwatch.org api.resourcewatch.org;
        client_max_body_size 1024m;
        client_body_timeout 120s;

        location /v1/gfw-metadata {
          rewrite ^/v1/gfw-metadata/(.*)$ /metadata/$1 break;
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://gis-gfw.wri.org;
        }

        location /cache/flush {
          if ($http_x_forwarded_proto != "https") {
            return 307 https://$http_host$request_uri;
          }
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://control-tower.default.svc.cluster.local;
        }

        location /auth {
          if ($http_x_forwarded_proto != "https") {
            return 307 https://$http_host$request_uri;
          }
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://control-tower.default.svc.cluster.local;
        }

        location /api {
          if ($http_x_forwarded_proto != "https") {
            return 307 https://$http_host$request_uri;
          }
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://control-tower.default.svc.cluster.local;
        }

        location /v1 {
          if ($http_x_forwarded_proto != "https") {
            return 307 https://$http_host$request_uri;
          }
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://control-tower.default.svc.cluster.local;
        }

        location /v2 {
          if ($http_x_forwarded_proto != "https") {
            return 307 https://$http_host$request_uri;
          }
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://control-tower.default.svc.cluster.local;
        }

        location /documentation {
          if ($http_x_forwarded_proto != "https") {
            return 307 https://$http_host$request_uri;
          }
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://doc.default.svc.cluster.local;
        }

        location / {
          if ($http_x_forwarded_proto != "https") {
            return 307 https://$http_host$request_uri;
          }
    	    rewrite ^(.*)$ /v1$1 break;
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://control-tower.default.svc.cluster.local;
        }

}


server {
        listen 80;

        server_name resourcewatch.vizzuality.com
        client_max_body_size 10m;
        client_body_timeout 120s;
        large_client_header_buffers 4 128k;

        location /api {
          if ($http_x_forwarded_proto != "https") {
            return 307 https://$http_host$request_uri;
          }
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://resource-watch-manager-staging.default.svc.cluster.local;
        }
        location /manager {
          if ($http_x_forwarded_proto != "https") {
            return 307 https://$http_host$request_uri;
          }
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://resource-watch-manager-staging.default.svc.cluster.local;
        }
        location /assets {
          if ($http_x_forwarded_proto != "https") {
            return 307 https://$http_host$request_uri;
          }
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://resource-watch-manager-staging.default.svc.cluster.local;
        }
        location /authentication {
          if ($http_x_forwarded_proto != "https") {
            return 307 https://$http_host$request_uri;
          }
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://resource-watch-manager-staging.default.svc.cluster.local;
        }

        location / {
          if ($http_x_forwarded_proto != "https") {
            return 307 https://$http_host$request_uri;
          }
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://resource-watch-staging.default.svc.cluster.local;
        }
}

server {
        listen 80;

        server_name staging.prepdata.org;
        client_max_body_size 10m;
        client_body_timeout 120s;

        location /api {
          if ($http_x_forwarded_proto != "https") {
            return 307 https://$http_host$request_uri;
          }
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-api-staging.default.svc.cluster.local;
        }
        location /manager {
          if ($http_x_forwarded_proto != "https") {
            return 307 https://$http_host$request_uri;
          }
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-api-staging.default.svc.cluster.local;
        }
        location /assets {
          if ($http_x_forwarded_proto != "https") {
            return 307 https://$http_host$request_uri;
          }
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-api-staging.default.svc.cluster.local;
        }
        location /authentication {
          if ($http_x_forwarded_proto != "https") {
            return 307 https://$http_host$request_uri;
          }
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-api-staging.default.svc.cluster.local;
        }
        location ~ ^\/dashboards\/.* {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-staging.default.svc.cluster.local;
        }
        location /login {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-staging.default.svc.cluster.local;
        }
        location /logout {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-staging.default.svc.cluster.local;
        }
        location /myprep-detail {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-staging.default.svc.cluster.local;
        }
        location /auth {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-staging.default.svc.cluster.local;
        }
        location /_next {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-staging.default.svc.cluster.local;
        }
        location /static {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-staging.default.svc.cluster.local;
        }
        location /styles/ {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-staging.default.svc.cluster.local;
        }
        location /admin {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-staging.default.svc.cluster.local;
        }

        location /myprep {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-staging.default.svc.cluster.local;
        }

        location /embed/widget {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-staging.default.svc.cluster.local;
        }

        location /embed/text {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-staging.default.svc.cluster.local;
        }

        location /embed/map {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-staging.default.svc.cluster.local;
        }

        location /embed/dataset {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-staging.default.svc.cluster.local;
        }

        location /embed/layers {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-staging.default.svc.cluster.local;
        }

        location /embed/table {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-staging.default.svc.cluster.local;
        }

        location /embed/dashboard {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-staging.default.svc.cluster.local;
        }

        location /embed/embed {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-staging.default.svc.cluster.local;
        }

        location / {
          if ($http_x_forwarded_proto != "https") {
            return 307 https://$http_host$request_uri;
          }
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-app-staging.default.svc.cluster.local;
        }
}

server {
        listen 80;

        server_name preproduction.prepdata.org;
        client_max_body_size 10m;
        client_body_timeout 120s;

        location /api {
          if ($http_x_forwarded_proto != "https") {
            return 307 https://$http_host$request_uri;
          }
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-api-preproduction.default.svc.cluster.local;
        }
        location ~ ^\/dashboards\/.* {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-preproduction.default.svc.cluster.local;
        }
        location /login {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-preproduction.default.svc.cluster.local;
        }
        location /logout {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-preproduction.default.svc.cluster.local;
        }
        location /myprep-detail {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-preproduction.default.svc.cluster.local;
        }
        location /auth {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-preproduction.default.svc.cluster.local;
        }
        location /_next {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-preproduction.default.svc.cluster.local;
        }
        location /static {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-preproduction.default.svc.cluster.local;
        }
        location /styles/ {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-preproduction.default.svc.cluster.local;
        }
        location /admin {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-preproduction.default.svc.cluster.local;
        }

        location /myprep {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-preproduction.default.svc.cluster.local;
        }

        location /embed/widget {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-preproduction.default.svc.cluster.local;
        }

        location /embed/text {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-preproduction.default.svc.cluster.local;
        }

        location /embed/map {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-preproduction.default.svc.cluster.local;
        }

        location /embed/dataset {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-preproduction.default.svc.cluster.local;
        }

        location /embed/layers {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-preproduction.default.svc.cluster.local;
        }

        location /embed/table {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-preproduction.default.svc.cluster.local;
        }
        location /embed/embed {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-preproduction.default.svc.cluster.local;
        }

        location /embed/dashboard {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager-preproduction.default.svc.cluster.local;
        }

        location / {
          if ($http_x_forwarded_proto != "https") {
            return 307 https://$http_host$request_uri;
          }
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-app-preproduction.default.svc.cluster.local;
        }
}

server {
        listen 80;

        server_name beta.prepdata.org www.prepdata.org prepdata.org;
        client_max_body_size 10m;
        client_body_timeout 120s;

        location /api {
          if ($http_x_forwarded_proto != "https") {
            return 307 https://$http_host$request_uri;
          }
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-api.default.svc.cluster.local;
        }
        location ~ ^\/dashboards\/.* {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager.default.svc.cluster.local;
        }
        location /login {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager.default.svc.cluster.local;
        }
        location /logout {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager.default.svc.cluster.local;
        }
        location /myprep-detail {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager.default.svc.cluster.local;
        }
        location /myprep {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager.default.svc.cluster.local;
        }
        location /auth {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager.default.svc.cluster.local;
        }
        location /_next {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager.default.svc.cluster.local;
        }
        location /static {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager.default.svc.cluster.local;
        }
        location /styles/ {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager.default.svc.cluster.local;
        }
        location /admin {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager.default.svc.cluster.local;
        }

        location /embed/widget {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager.default.svc.cluster.local;
        }

        location /embed/embed {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager.default.svc.cluster.local;
        }
        location /embed/text {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager.default.svc.cluster.local;
        }

        location /embed/map {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager.default.svc.cluster.local;
        }

        location /embed/dataset {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager.default.svc.cluster.local;
        }

        location /embed/layers {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager.default.svc.cluster.local;
        }

        location /embed/table {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager.default.svc.cluster.local;
        }

        location /embed/dashboard {
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-manager.default.svc.cluster.local;
        }

        location / {
          if ($http_x_forwarded_proto != "https") {
            return 307 https://$http_host$request_uri;
          }
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://prep-app.default.svc.cluster.local;
        }
}

server {
        listen 80;

        server_name staging.resourcewatch.org;
        client_max_body_size 10m;
        client_body_timeout 120s;

        large_client_header_buffers 4 128k;

        location /api {
          if ($http_x_forwarded_proto != "https") {
            return 307 https://$http_host$request_uri;
          }
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://resource-watch-manager.default.svc.cluster.local;
        }

        location /manager {
          if ($http_x_forwarded_proto != "https") {
            return 307 https://$http_host$request_uri;
          }
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://resource-watch-manager.default.svc.cluster.local;
        }
        location /assets {
          if ($http_x_forwarded_proto != "https") {
            return 307 https://$http_host$request_uri;
          }
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://resource-watch-manager.default.svc.cluster.local;
        }
        location /authentication {
          if ($http_x_forwarded_proto != "https") {
            return 307 https://$http_host$request_uri;
          }
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://resource-watch-manager.default.svc.cluster.local;
        }


        location /blog {
          if ($http_x_forwarded_proto != "https") {
            return 307 https://$http_host$request_uri;
          }
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://35.192.20.172:80;
        }



        location / {
          if ($http_x_forwarded_proto != "https") {
            return 307 https://$http_host$request_uri;
          }
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://resource-watch.default.svc.cluster.local;
        }
}

server {
        listen 80;

        server_name emissionspathways.org www.emissionspathways.org;
        client_max_body_size 10m;
        client_body_timeout 120s;

        location / {
          return 307 https://www.climatewatchdata.org/emission-pathways;
        }
}

server {
        listen 80;

        server_name data.emissionspathways.org;
        client_max_body_size 10m;
        client_body_timeout 120s;

        location / {
          if ($http_x_forwarded_proto != "https") {
            return 307 https://$http_host$request_uri;
          }
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://emissions-scenario-portal.default.svc.cluster.local;
        }
}
server {
        listen 80;

        server_name climate-watch.vizzuality.com;
        client_max_body_size 10m;
        client_body_timeout 120s;

        location / {
          if ($http_x_forwarded_proto != "https") {
            return 307 https://$http_host$request_uri;
          }
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://climate-watch-staging.default.svc.cluster.local;
        }
}

server {
        listen 80;

        server_name beta.climatewatchdata.org climatewatchdata.org www.climatedata.org climatedata.org;
        client_max_body_size 10m;
        client_body_timeout 120s;

        location / {
          return 307 https://www.climatewatchdata.org$request_uri;
        }
}

server {
        listen 80;

        server_name www.climatewatchdata.org;
        client_max_body_size 10m;
        client_body_timeout 120s;

        location / {
          if ($http_x_forwarded_proto != "https") {
            return 307 https://$http_host$request_uri;
          }
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header Host $http_host;
          proxy_redirect off;
          proxy_pass http://climate-watch.default.svc.cluster.local;
        }
}
